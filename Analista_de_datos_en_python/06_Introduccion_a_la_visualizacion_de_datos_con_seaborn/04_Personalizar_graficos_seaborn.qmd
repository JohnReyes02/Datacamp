---
title: "Personalizar los gráficos de Seaborn"
author: "Edwin John Fredy Reyes Aguirre"
date: today
toc: true
toc-title: "Contenido"
---

En este último capítulo, aprenderás a añadir títulos informativos a los gráficos y etiquetas a los ejes, ¡que son una de las partes más importantes de cualquier visualización de datos! También aprenderás a personalizar el estilo de tus visualizaciones para orientar más rápidamente a tu audiencia hacia los puntos clave. Después, pondrás en común todo lo que has aprendido en los ejercicios finales del curso.

## Cambiar el estilo y el color de la trama

-   Por qué personalizar?
    -   Razones para cambiar de estilo:
        -   Preferencias personales
        -   Mejorar la legibilidad
        -   Guiar la interpretación
-   Cambiando los estilos de las figuras
    -   Los estilos de las figuras incluyen el fondo y los ejes
    -   Opciones: "white", "dark", "whitegrid", "darkgrid", "ticks"
    -   Para establecer uno de ellos como estilo global para todos los gráficos se utiliza `sns.set_style()`
-   Estilo de figura por defecto ("white")
    -   Si solo nos interesa la tendencia general:

```{python}
#| echo: true
#| eval: false
sns.catplot(x='age', y='masculinity_important',
            data=masculinity_data,
            hue='feel_masculine',
            kind='point')
plt.show()
```

![](images/paste-27.png){width="370"}

-   Estilo de figura: "whitegrid"
    -   Para determinar valores específicos:

```{python}
#| echo: true
#| eval: false
sns.set_style('whitegrid')

sns.catplot(x='age', y='masculinity_important',
            data=masculinity_data,
            hue='feel_masculine',
            kind='point')
plt.show()
```

![](images/paste-28.png){width="370"}

-   Cambiando la paleta
    -   Los cambios en la paleta de la figura, cambia el color de los elementos principales del gráfico
    -   `sns.set_palette()`
    -   Use las paletas preestablecidas o personalizadas
-   Paletas divergentes

![](images/paste-29.png){width="370"}

-   Ejemplo (Paleta divergente)

```{python}
#| echo: true
#| eval: false
sns.set_palette('RdBu')

category_order = ["No answer",
                  "Not al all",
                  "Not very",
                  "Somewhat",
                  "Very"]

sns.catplot(x='how_masculine',
            data=masculinity_data,
            kind='count',
            order=category_order)
plt.show()
```

![](images/paste-30.png){width="370"}

-   Paletas secuenciales

![](images/paste-31.png){width="370"}

-   Ejemplo de paleta secuencial

![](images/paste-32.png){width="370"}

-   Paletas personalizadas

```{python}
#| echo: true
#| eval: false
custom_palette = ["red", "green", "orange", "blue",
                  "yellow", "purple"]

sns.set_palette(custom_palette)
```

![](images/paste-34.png){width="370"}

```{python}
#| echo: true
#| eval: false
custom_palette = ["#FBB4AE", "#B3CDE3", "#CCEBC5",
                  "#DECBE4", "#FED9A6", "#FFFFCC",
                  "#E5B8BD", "#FDDAEC", "#F2F2F2"]

sns.set_palette(custom_palette)
```

![](images/paste-33.png){width="370"}

-   Cambiar la escala del gráfico

    -   En las figuras "context" cambia la escala de los elementos y etiquetas del gráfico

    -   \`sns.set_context()\`

    -   Del mas pequeño al más grande: "paper", "notebook", "talk", "poster".

-   Contexto por defecto: "paper"

```{python}
#| echo: true
#| eval: false
sns.catplot(x='age',
            y='masculinity_important',
            data=masculinity_data,
            hue='feel_masculine',
            kind='point')

plt.show()
```

![](images/paste-35.png){width="370"}

-   Contexto grande: "talk"
    -   Presentaciones donde el público este mas alejado del gráfico

```{python}
#| echo: true
#| eval: false
sns.set_context('talk')

sns.catplot(x='age',
            y='masculinity_important',
            data=masculinity_data,
            hue='feel_masculine',
            kind='point')

plt.show()
```

![](images/paste-36.png){width="370"}

### Cambiar de estilo y de paleta

Vamos a nuestro conjunto de datos que contiene los resultados de una encuestra realizada a jóvenes sobre sus hábitos y preferencias. Hemos proportcionado el código para crear un gráfico de recuento de sus respuestas a la pregunta "¿Con qué frecuencia escuchas los consejos de tus padres?". Ahora vamos a cambiar el estilo y la paleta para que esta trama sea más fácil de interpretar.

```{python}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

ruta = './data/young-people-survey-responses.csv'
survey_data = pd.read_csv(ruta, index_col=0)
survey_data.head()
```

Transformación de los datos de la columna `"Parents' advice"`

```{python}
survey_data["Parents' advice"] = survey_data["Parents' advice"].map({1: 'Never',
                                                                     2: 'Rarely',
                                                                     3: 'Sometimes',
                                                                     4: 'Often',
                                                                     5: 'Always'})
```

#### Instrucciones

1.  Configura el estilo en `"whitegrid"` para ayudar al público a determinar el número de respuestas de cada categoría.

```{python}
# Set the style to "whitegrid"
sns.set_style('whitegrid')

# Create a count plot or survey responses
category_order = ['Never', 'Rarely', 'Sometimes',
                  'Often', 'Always']

sns.catplot(x="Parents' advice",
            data=survey_data,
            kind='count',
            order=category_order)

# Show plot
plt.show()
```

2.  Establece la paleta de colores en la paleta secuencial denominada `"Purples`.

```{python}
# Set the color palette to "Purples"
sns.set_style('whitegrid')
sns.set_palette('Purples')

# Create a count plot or survey responses
category_order = ['Never', 'Rarely', 'Sometimes',
                  'Often', 'Always']

sns.catplot(x="Parents' advice",
            data=survey_data,
            kind='count',
            order=category_order,
            hue="Parents' advice", legend=False)

# Show plot
plt.show()
```

3.  Cambia la paleta de colores a la paleta divergente `"RdBu"`

```{python}
# Change the color palette to "RdBu"
sns.set_style('whitegrid')
sns.set_palette('RdBu')

# Create a count plot or survey responses
category_order = ['Never', 'Rarely', 'Sometimes',
                  'Often', 'Always']

sns.catplot(x="Parents' advice",
            data=survey_data,
            kind='count', 
            hue="Parents' advice", legend=False,
            order=category_order)

# Show plot
plt.show()
```

Este estilo y la paleta de colores divergente resaltan mejor la diferencia entre el número de jóvenes que suelen escuchar los consejos de sus padres frente a los que no lo hacen.

### Cambiar la escala

En este ejercicio, seguiremos examinando el conjunto de datos que contienen las respuestas de una encuesta a jóvenes. ¿Varía el porcentaje de personas que declaran sentirse solas en función del número de hermanos que tienen? Averigüémoslo utlizando un diagrama de barras, al tiempo que exploramos las cuatro escalas de diagrama diferentes de Seaborn. ("contextos").

#### Instrucciones

1.  Establece la escala ("contexto") en `"paper"`, que es la más pequieña de las opciones de escala.

```{python}
# Set the context to "paper"
sns.set_context('paper')

# Create bar plot
sns.catplot(x='Siblings', y='Loneliness',
            data=survey_data, 
            kind='bar', 
            hue='Siblings', legend=False)

# Show plot
plt.show()
```

2.  Cambia el contexto a `"notebook"` para aumentar la escala.

```{python}
# Change the context to "notebook"
sns.set_context("notebook")

# Create a bar plot
sns.catplot(x='Siblings', y='Loneliness',
            data=survey_data, 
            kind='bar', 
            hue='Siblings', legend=False)

# Show plot
plt.show()
```

3.  Cambia el contexto a `"talk"` para aumentar la escala.

```{python}
# Change the context to "notebook"
sns.set_context("talk")

# Create a bar plot
sns.catplot(x='Siblings', y='Loneliness',
            data=survey_data, 
            kind='bar', 
            hue='Siblings', legend=False)

# Show plot
plt.show()
```

4.  Cambia el contexto a `"poster"`, que es la mayor escala disponbible.

```{python}
# Change the context to "poster"
sns.set_context("poster")

# Create a bar plot
sns.catplot(x='Siblings', y='Loneliness',
            data=survey_data, 
            kind='bar', 
            hue='Siblings', legend=False)

# Show plot
plt.show()
```

Cada nombre de contexto da la sugerencia de Seaborn sobre cuándo usar una escala de gráfico dada (es un artículo, en un cuadrno de iPythonm en una charla/presentación o en una sesión de póster).

### Utilizar una paleta personalizada

Hasta ahora, hemos analizado varias cosas en el conjunto de datos de las respuestas a las encuestas de los jóvenes, como el uso que hacen de internet, la frecuencia con que escuchan a sus padres y cuántos de ellos dicen sentirse solos. Sin embargo, algo que no hemos hecho es un resumen básico del tipo de personas que responden a esta encuesta, incluyendo su edad y género. Proporcionar estos resúmenes básicos es siempre una buena práctica cuando se trata de un conjunto de datos desconocido.

El código proporcionado creará un diagrama de cajas que mostrará la distribución de edades de los encuestados masculinos frente a los femeninos. Vamos a ajustar el código para personalizar la apariencia , esta vez utilizando una paleta de colores personalizada.

#### Instrucciones

-   Establece el estilo en `"darkgrid"`.

-   Establece una paleta de colores personalizada con los códigos hexadecimales de color `"#39A7D0"` y `"#36ADA4"`.

```{python}
sns.set_context('notebook')

# Set the style to "darkgrid"
sns.set_style('darkgrid')

# Set a custom color palette
sns.set_palette(['#39A7D0', '#36ADA4'])

# Create the box plot of age distribution by gender
sns.catplot(x='Gender', y='Age',
            data=survey_data, kind='box',
            hue='Gender', legend=False)  # se agregan pues palette sera deprecated

# Show plot
plt.show()
```

Parece que la edad media es la misma para hombres y mujeres, pero la distribución de las mujeres se inclina hacia edades más jóvenes que la de los hombres.

## Añadir títulos y etiquetas: Parte 1

-   Creando visualizaciones informativas
    -   Se añade un título.
    -   Las etiquetas de los ejes son informativas.
    -   Las etiquetas del eje x estan giradas para mayor claridad.

![](images/paste-37.png){width="570"}

-   Objetos FacetGrid vs. AxesSubplot

    -   Los gráficos de Seaborn creean dos diferentes tipos de objetos: `FacetGrid` y `AxesSubplot`.

```{python}
#| echo: true
#| eval: false
g = sns.scatterplot(x='height', y='weight', data=df)
type(g)
```

 > matplotlib.axes._subplots.AxesSubplot

-   FacetGrid vacío

    -   Esta formado por uno o varios AxesSuubplots

        ![](images/paste-38.png){width="370"}

-   Objetos FacetGrid vs. AxesSubplot

    | Tipo de Objeto | Tipo de gráfico                  | Características      |
    |----------------|----------------------------------|----------------------|
    | `FacetGrid`    | `relplot()`, `catplot()`         | Puede crear subplots |
    | `AxesSubplot`  | `scatterplot`, `countplot`, etc. | Crea un solo gráfico |

-   Añadiendo un título al FacetGrid

```{python}
#| echo: true
#| eval: false
g = sns.catplot(x='Region', y='Birthrate',
                data=gdp_data, kind='box')

g.fig.suptitle('New Title',
                y=1.03)

plt.show()
```

![](images/paste-39.png){width="370"}


### FacetGrids vs. AxesSubplots

En la lección reciente, aprendimos que las funciones de trazado de Seaborn crean dos tipos diferentes de objetos: objetos `FacetGrid` y objetos `AxesSubplot`. El método para añadir un título a tu gráfico variará en función del tipo de objeto que sea.

En el código proporcionadom hemos utilizado `relplot()` con el conjunto de datos de millas por galón para crear un gráfico de dispersión que muestra la realación entre el peso de un coche y su potencia. Este gráfico de dispersión se asigna a la variable `g`. Identifiquemos de qué tipo de objeto se trata.

```{python}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

ruta = './data/mpg.csv'
mpg = pd.read_csv(ruta)
mpg.head()
```

#### Instrucciones

1. Identifica qué tipo de objeto es el gráfico `g` y asígnalo a la variable `type_of_g`

```{python}
# Create a scatter plot
g = sns.relplot(x='weight', y='horsepower',
                    data=mpg, kind='scatter')

# Identify plot type
type_of_g = type(g)

# Print type
print(type_of_g)
```
2. **Pregunta**

Acabamos de ver que `sns.relplot()` crea objetos FacetGrid. ¿Qué otra función Seaborn crea un objeto FacetGrid en lugar de un objeto AxesSubplot?

**Respuestas posibles**

- [X] `sns.catplot()`
- [ ] `sns.scatterplot()`
- [ ] `sns.boxplot()`
- [ ] `sns.countplot()`

`catplot()` admite la creación de subgráficos, por lo que crea un objeto `FacetGrid`.

### Añadir un título a un objeto FacetGrid

## Añadir títulos y etiquetas: Parte 2

### Añadir un título y etiquetas de eje

### Rotar etiquetas x-tick

## Unirlo Todo

### Diagrama de cajas con subgrupos

### Diagrama de barras con subgrupos y subtramas

## ¡Bien hecho! ¿Y ahora qué?